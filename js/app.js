angular.module("YTPlaylistManager",["ngMaterial","ngMdIcons"]);
angular.module("YTPlaylistManager").config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("light-blue").accentPalette("red",{"default":"900"})}]);
angular.module("YTPlaylistManager").constant("$config",{API_KEY:"AIzaSyDJIOlGzyjPFEQ5j-Q2qEJVbOJtgqmby_Y",CLIENT_ID:"877549163404-chjiknp3ffeiatmb2mcb8dfp23u7sm8q.apps.googleusercontent.com",SCOPE:"https://www.googleapis.com/auth/youtube"});
angular.module("YTPlaylistManager").run(["$rootScope","YTResourceProvider","channel",function(e,a,o){$(window).load(function(){e.$broadcast("pageLoaded");var n=JSON.parse(localStorage.options);n&&(o.options=n),n.autologin&&a.login().then(function(a){var n=a.result.items[0];o.basicInfo={authorized:!0,userId:n.id,username:n.snippet.title,profilePic:n.snippet.thumbnails["default"].url,bgPic:n.brandingSettings.image.bannerMobileImageUrl},e.$broadcast("loggedIn"),$(".preloader-wrapper").fadeOut()})})}]);
angular.module("YTPlaylistManager").controller("aboutModalCtrl",["$scope","$mdDialog",function(l,o){l.hide=function(){o.hide()}}]);
angular.module("YTPlaylistManager").controller("mainCtrl",["$scope","channel",function(n,o){n.$on("loggedIn",function(){n.info=o.basicInfo,n.options=o.options})}]);
angular.module("YTPlaylistManager").controller("playerCtrl",["$rootScope","$scope","$interval","channel",function(e,o,i,t){function a(){if(t.authorized&&t.options.quality)return t.options.quality;var e=window.innerWidth;return e>=1920?"hd1080":1920>e&&e>=1280?"hd720":1280>e&&e>=854?"large":854>e&&e>=640?"medium":640>e?"small":void 0}function l(e){o.playStatusIcon=1==e.data?"pause":"play_arrow",o.currentVideoDuration=o.player.getDuration(),o.playerState=e.data,o.$apply()}function n(e){o.volumeStatusIcon=0===e?"volume_off":e>0&&33>=e?"volume_mute":e>33&&66>=e?"volume_down":"volume_up"}function d(){o.currentVideoDuration=o.player.getDuration(),o.playerVolume=o.player.getVolume(),t.basicInfo.authorized||(t.activePlaylist=t.mockPlaylist,o.currentVideo=t.activePlaylist.videos[t.activeVideoIndex])}o.playStatusIcon="play_arrow",o.volumeStatusIcon="volume_up",o.playPosition="0%",o.playerVolume=100,o.previousVolume=100,o.playerState=-1,o.activePlaylist=t.activePlaylist,o.activeVideoindex=t.activeVideoindex,o.videoQuality=a(),o.playPauseVideo=function(){1===o.playerState?o.player.pauseVideo():o.player.playVideo()},o.stopVideo=function(){o.player.seekTo(0),o.player.stopVideo()},o.muteVideo=function(){var e=0!==o.playerVolume?0:o.previousVolume;o.previousVolume=o.playerVolume,o.playerVolume=e,o.player.setVolume(e),n(e)},o.adjustVolume=function(){o.player.setVolume(o.playerVolume),n(o.playerVolume)},o.init=function(){o.player=new YT.Player("player",{height:"100%",width:"100%",videoId:t.mockPlaylist.videos[t.activeVideoIndex].id,playerVars:{controls:0,disablekb:1,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3},events:{onStateChange:l,onReady:d}})},o.changePlayingPosition=function(e){var i=$(".video-progress").offset().left,t=(100*(e.clientX-i)/229).toFixed(4),a=(o.currentVideoDuration*t/100).toFixed(2);o.playPosition=t+"%",o.player.seekTo(a)},o.previousVideo=function(){t.activeVideoIndex--,t.activeVideoIndex<0&&(t.activeVideoIndex=t.activePlaylist.videos.length-1),o.currentVideo=t.activePlaylist.videos[t.activeVideoIndex],o.player.loadVideoById({videoId:o.currentVideo.id,suggestedQuality:o.videoQuality})},o.nextVideo=function(){t.activeVideoIndex++,t.activeVideoIndex>=t.activePlaylist.videos.length&&(t.activeVideoIndex=0),o.currentVideo=t.activePlaylist.videos[t.activeVideoIndex],o.player.loadVideoById({videoId:o.currentVideo.id,suggestedQuality:o.videoQuality})},i(function(){1===o.playerState&&(o.playPosition=100*o.player.getCurrentTime()/o.currentVideoDuration+"%")},500),o.$on("pageLoaded",o.init),o.$on("loggedIn",function(){t.options.autoplay&&o.player.playVideo()})}]);
angular.module("YTPlaylistManager").controller("playlistCtrl",["$scope","$timeout","YTResourceProvider","channel",function(e,l,n,t){e.togglePlaylist=function(e){var n=angular.element(e.currentTarget.parentNode.parentNode),t=angular.element(document.querySelector(".playlist.opened"));t.length?(t.addClass("closing"),l(function(){t.removeClass("opened").removeClass("closing")},500)):(n.addClass("opening"),l(function(){n.removeClass("opening").addClass("opened")},500))},e.getPlaylists=function(){var l={channelId:t.basicInfo.userId,part:"snippet,contentDetails,status"};n.sendRequest("playlists.list",l).then(function(l){t.playlists.concat(l.result.items),e.playlists=t.playlists,console.log(l)})},e.$on("loggedIn",e.getPlaylists)}]);
angular.module("YTPlaylistManager").controller("sidebarCtrl",["$scope","channel","YTResourceProvider","$mdToast","$mdSidenav","$mdDialog",function(e,t,n,o,i,s){e.settingsIcon="expand_more",e.settingsOpened=!1,e.login=function(){n.login().then(function(t){var n=t.result.items[0];e.info={authorized:!0,username:n.snippet.title,profilePic:n.snippet.thumbnails["default"].url,bgPic:n.brandingSettings.image.bannerMobileImageUrl}},function(e){o.show(o.simple().content(e.error.code+" "+e.error.message).highlightAction(!1).position({top:!0,right:!0}))})},e.toggleSidenav=function(){i("sidenav").toggle()},e.showAbout=function(e){s.show({controller:"aboutModalCtrl",templateUrl:"/dist/assets/templates/about.modal.html",parent:angular.element(document.body),targetEvent:e})},e.toggleSettings=function(){e.settingsIcon="expand_more"===e.settingsIcon?"expand_less":"expand_more",e.settingsOpened=!e.settingsOpened},e.saveSettings=function(){localStorage.options=JSON.stringify(e.options)}}]);
angular.module("YTPlaylistManager").directive("draggableElem",["$document",function(e){return{restrict:"A",replace:!1,link:function(t,l,r){function n(e){a.css({left:e.clientX,top:e.clientY,bottom:"auto"})}function o(t){e.off("mousemove",n),e.off("mouseup",o)}var a=$(r.draggableElem);l.on("mousedown",function(t){t.preventDefault(),e.on("mousemove",n),e.on("mouseup",o)})}}}]).directive("mainSidebar",function(){return{restrict:"E",replace:!0,templateUrl:"../assets/templates/sidebar.html",controller:"sidebarCtrl"}}).directive("controlPanel",function(){return{restrict:"E",replace:!0,templateUrl:"../assets/templates/control.panel.html",controller:"playerCtrl"}}).directive("playlist",function(){return{restrict:"E",replace:!0,templateUrl:"../assets/templates/playlist.html",controller:"playlistCtrl"}});
angular.module("YTPlaylistManager").service("channel",function(){var i={basicInfo:{authorized:!1},options:{},activePlaylist:null,activeVideoIndex:1,playlists:[],mockPlaylist:{snippet:{title:"Sample Playlist",thumbnails:{medium:{url:"assets/img/noth.png"}}},videos:[{id:"o3mP3mJDL2k",snippet:{title:"Shakira - Can't Remember to Forget You ft. Rihanna"}},{id:"tuMgJrFoAFY",snippet:{title:"Ten Walls - Walking With Elephants [Official Video]"}},{id:"ESXgJ9-H-2U",snippet:{title:"Kiesza - Hideaway (Official Video)"}},{id:"SYM-RJwSGQ8",snippet:{title:"Tove Lo - Habits (Stay High) - Hippie Sabotage Remix"}},{id:"81EdENK_9qQ",snippet:{title:"SPADA & ELEN LEVON - Cool Enough (Official Video)"}},{id:"L8eRzOYhLuw",snippet:{title:"Ariana Grande - Break Free ft. Zedd"}},{id:"gCYcHz2k5x0",snippet:{title:"Martin Garrix - Animals (Official Video)"}}]}};return i});
angular.module("YTPlaylistManager").service("YTResourceProvider",["$q","$config",function(e,r){var i={};return i.login=function(){var i=e.defer();return gapi.client.setApiKey=r.API_KEY,gapi.auth.authorize({client_id:r.CLIENT_ID,scope:r.SCOPE,immediate:!0},function(){gapi.client.load("youtube","v3",function(){var e=gapi.client.youtube.channels.list({mine:!0,part:"id, snippet, brandingSettings"});e.execute(function(e){e.error?i.reject(e.error):i.resolve(e)})})}),i.promise},i.sendRequest=function(r,i){var n=e.defer();r=r.split(".");var t=gapi.client.youtube[r[0]][r[1]](i);return t.execute(function(e){e.error?(console.log(e),n.reject()):(console.log(e),n.resolve(e))}),n.promise},i}]);